<!DOCTYPE html>
<html lang="fr">
  <head>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>

    <script>
      AFRAME.registerComponent('play-on-look', {
        init: function () {
          var el = this.el;
          el.addEventListener('mouseenter', function () {
            var video = document.querySelector('#video1');
            if (video) video.play();
          });
          el.addEventListener('mouseleave', function () {
            var video = document.querySelector('#video1');
            if (video) video.pause();
          });
        }
      });
    </script>
  </head>

  <body>

    <!-- ÉCRAN POUR ACTIVER LE SON -->
    <div id="startAudio"
         style="position: fixed; top:0; left:0; width:100%; height:100%;
                background:black; color:white; display:flex; 
                justify-content:center; align-items:center; font-size:28px;
                cursor:pointer; z-index: 999;">
      Cliquer pour activer le son
    </div>

    <a-scene>

      <a-assets>
        <a-asset-item id="table" src="assets/object/classic_round_side_table.glb"></a-asset-item>
        <a-asset-item id="mobile1" src="assets/object/mobile1.glb"></a-asset-item>
        <a-asset-item id="mobile2" src="assets/object/mobile2.glb"></a-asset-item>
        <a-asset-item id="mobile3" src="assets/object/mobile3.glb"></a-asset-item>

        <video id="video1"
               src="assets/films/Temoin1extra.mp4"
               playsinline
               crossorigin="anonymous"
               muted>
        </video>
      </a-assets>

      <a-entity camera look-controls>
        <a-entity cursor="fuse: true; fuseTimeout: 800"
                  raycaster="objects: .playable"
                  position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="shader: flat; color: white">
        </a-entity>
      </a-entity>

      <a-entity id="global">
        <a-entity id="table" gltf-model="#table" scale="3 0.21914 3" position="0 0.22454 0"></a-entity>

        <a-entity id="telephone" position="0 0.33236 0" scale="0.5 0.5 0.5">
          <a-entity id="mobile1" gltf-model="#mobile1"
                    scale="0.1 0.08076 0.1"
                    position="-0.05093 1.8343 0.2881"
                    rotation="0 -56.75 0">
          </a-entity>

          <a-entity id="mobile2" gltf-model="#mobile2"
                    scale="0.01 0.01 0.01"
                    position="0.09615 1.87665 -0.0558">
          </a-entity>

          <a-entity id="mobile3" gltf-model="#mobile3"
                    position="0.48662 1.82716 0.40181"
                    scale="0.5 0.5 0.39934"
                    rotation="90 -120.43 0">
          </a-entity>
        </a-entity>
      </a-entity>

<a-video id="videopanel" class="playable" play-on-look
         src="#video1"
         width="16"
         height="9"
         position="0.0506 1.24713 -0.02656"
         scale="0.01335 0.04941 0.1">
</a-video>


    </a-scene>

    <!-- Script d’activation audio -->
    <script>
      document.querySelector('#startAudio').addEventListener('click', function () {
        var video = document.querySelector('#video1');

        video.muted = false;
        video.play().catch(() => {});

        document.querySelector('#startAudio').style.display = 'none';
      });
    </script>

  </body>
</html>
