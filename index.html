<!DOCTYPE html>
<html lang="fr">
<head>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>

    <!-- Composant générique : joue/stoppe la vidéo liée -->
    <script>
        AFRAME.registerComponent('play-on-look', {
            schema: { video: { type: 'selector' } },
            init: function () {
                const vid = this.data.video;
                const el = this.el;

                el.addEventListener('mouseenter', () => {
                    if (vid) vid.play();
                });

                el.addEventListener('mouseleave', () => {
                    if (vid) vid.pause();
                });
            }
        });
    </script>
</head>
<body>
    <!-- Écran pour activer le son -->
    <div id="startAudio" 
         style="position: fixed; top:0; left:0; width:100%; height:100%; background:black; color:white; display:flex; justify-content:center; align-items:center; font-size:28px; cursor:pointer; z-index: 999;">
        Cliquer pour commencer
    </div>

    <a-scene>
        <a-assets>
            <a-asset-item id="table" src="assets/object/classic_round_side_table.glb"></a-asset-item>
            <a-asset-item id="mobile1" src="assets/object/mobile1.glb"></a-asset-item>
            <a-asset-item id="mobile2" src="assets/object/mobile2.glb"></a-asset-item>
            <a-asset-item id="mobile3" src="assets/object/mobile3.glb"></a-asset-item>
            
            <img id="frise" src="assets/object/frise.jpg">

            <video id="video1" src="assets/films/Temoin1extra.mp4" playsinline crossorigin="anonymous"></video>
            <video id="video2" src="assets/films/Temoin2extra.mp4" playsinline crossorigin="anonymous"></video>
            <video id="video3" src="assets/films/Temoin3extra.mp4" playsinline crossorigin="anonymous"></video>
        </a-assets>

        <a-entity camera look-controls position="0 1.6 4.41422" rotation="-0.802 -0.573 0">
            <a-entity id="cursor" 
                      cursor="fuse: true; fuseTimeout: 800" 
                      raycaster="objects: .playable" 
                      position="0 0 -1" 
                      geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03" 
                      material="shader: flat; color: #ff1111">
            </a-entity>
        </a-entity>

        <a-entity id="global" position="0 0.02 3.143">
            <a-image src="#frise"></a-image>
            
            <a-entity gltf-model="assets/object/classic_round_side_table.glb" scale="1.27891 0.23741 1.22012" position="0 0.86 0"></a-entity>

            <a-entity position="0 0.33 0" scale="0.5 0.5 0.5">
                <a-entity id="tel1+video3">
                    <a-entity id="telephone1" 
                              gltf-model="#mobile1" 
                              scale="0.1 0.08 0.1" 
                              position="-0.05 1.83 0.28" 
                              rotation="0 -56.7 0">
                    </a-entity>

                        <a-video id="video3" class="playable" play-on-look="video: #video3" src="#video3" width="16" height="9" position="-0.08441 1.798 0.29972" rotation="0 -56.87580144925143 0" scale="0.03417 0.08137 0.1">
                    </a-video>
               
                </a-entity>


                <a-entity id="tel2+video1">
                    <a-entity id="telephone2" gltf-model="#mobile2" scale="0.01 0.01 0.01" position="0.096 1.87 -0.05"></a-entity>
                    <a-video id="video1" class="playable" play-on-look="video: #video1" src="#video1" width="16" height="9" position="0.10304 1.80643 -0.04651" scale="0.02967 0.10104 0.1"></a-video>
                </a-entity>


                <a-entity id="tel3+video2">
                    <a-entity id="telephone3" gltf-model="#mobile3" scale="0.5 0.5 0.39" position="0.48 1.82 0.40" rotation="90 -120 0"></a-entity>
                    <a-video id="video2" class="playable" play-on-look="video: #video2" src="#video2" width="16" height="9" position="0.30405 1.81499 0.30805" rotation="0 59.64000000000001 0" scale="0.03591 0.10571 0.1"></a-video>
                </a-entity>
            </a-entity>
        </a-entity>


    </a-scene>

    <script>
        document.querySelector('#startAudio').addEventListener('click', function () {
            ['#video1', '#video2', '#video3'].forEach(id => {
                const v = document.querySelector(id);
                v.muted = false;
                v.play().catch(() => {});
                v.pause(); // on ne lance pas la vidéo, on débloque juste le son
            });
            this.style.display = 'none';
        });
    </script>
</body>
</html>

<!--
                                                            ZONE DE DECOUPAGE 








<a-image src="#frise" material="blending: subtractive" position="0.01741 0.977 0.04519" rotation="-89.99047017663248 0 0" scale="1.98057 1.07929 1"></a-image>


















































-->
